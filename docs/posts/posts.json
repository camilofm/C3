[
  {
    "path": "posts/umbrella_pipeline/",
    "title": "Pipeline QM/MM para Umbrella Sampling: completamente automatizado",
    "description": "Comparto un pipeline para procesar ventanas de Umbrella Sampling, desde RMSD y solapamiento hasta WHAM y PMF, todo automatizado para QMMM PM6/CHARMM.",
    "author": [
      {
        "name": "Dr. Camilo Febres-Molina",
        "url": "https://github.com/camilofm"
      }
    ],
    "date": "2025-11-28",
    "categories": [],
    "contents": "\n\n\n\nIntroducci√≥n\nCuando se trabaja con Umbrella Sampling acoplado a QM/MM, el an√°lisis posterior puede volverse tedioso: copiar archivos desde el cl√∫ster, calcular RMSD por ventana, revisar solapamiento, preparar metadata, correr WHAM, limpiar extremos y finalmente obtener el perfil de energ√≠a libre (PMF).\nY si el proyecto es grande, esto f√°cilmente se convierte en horas de trabajo repetitivo.\nPor eso decid√≠ construir un pipeline completamente automatizado que recibe los archivos crudos (*.rc y *_eq.dcd) y produce todos los an√°lisis y gr√°ficos finales en aproximadamente 11 segundos.\nSolo ejecuto:\nbash run_pipeline.sh\ny obtengo:\nRMSD global, donor y acceptor ( o los que t√∫ requieras)\nGr√°fico de solapamiento de ventanas\nPMF WHAM original\nPMF limpio + spline suavizado\nFiguras PNG listas para manuscrito\nTodos los CSV procesados\nHTMLs de diagn√≥stico\nTodo organizado en una carpeta resultados/\nMi intenci√≥n con este post es compartir la estructura y l√≥gica del pipeline, por si a alguien m√°s le resulta √∫til.\n¬øQu√© hace exactamente el pipeline?\nEl pipeline ejecuta autom√°ticamente, en orden:\nrmsd_windows.tcl\nCalcula RMSD de la prote√≠na (PROA), donor (DON) y acceptor (ACC) usando VMD.\nrmsd_us_mep-rca.Rmd\nProcesa esos RMSD, genera los gr√°ficos globales y figuras por ventana.\nus_rc_overlap_np.Rmd\nCalcula el solapamiento entre ventanas y genera la figura de densidades.\ngen_metadata.sh\nConstruye el metadata que WHAM necesita (centros y constantes de fuerza).\nwham_rca_v6.py\nEjecuta WHAM 1D y produce el PMF crudo.\npmf_wham_final.Rmd\nLimpia extremos, recalibra ŒîG y genera la versi√≥n final con spline.\nCopia autom√°tica de PNG a resultados/\nAs√≠ no tengo que buscar nada despu√©s.\nCada paso queda registrado en pipeline.log, lo cual es muy √∫til para revisar o depurar.\nResultados generados autom√°ticamente\nRMSD global\nAqu√≠ un ejemplo de output para un RMSD de toda la prote√≠na:\n\n\n\nAqu√≠ para un ligando:\n\n\n\n(Si tambi√©n generas RMSD global para otro ligando, puedes a√±adir aqu√≠ rmsd_global_xx.png de la misma forma.)\nSolapamiento Umbrella\nAqu√≠ un ejemplo del output para el solapamiento de los umbrella:\n\n\n\nPMF WHAM (limpio + spline)\nFinalmente, aqu√≠ un ejemplo del output para el perfil de energ√≠a libre de Gibbs a trav√©s del c√°lculo PMF:\n\n\n\nArquitectura del script maestro\nEl coraz√≥n del flujo es run_pipeline.sh.\nAqu√≠ va un extracto muy simplificado:\nrun_step \"3. Generar solapamiento de RC\"   env RSTUDIO_PANDOC=\"$PANDOC_BIN\"   Rscript -e \"rmarkdown::render('us_rc_overlap_np.Rmd', quiet = TRUE)\"\n\nrun_step \"7. Copiar im√°genes finales\"   bash copy_outputs.sh\nTodo est√° encapsulado en funciones y logs, as√≠ que si algo falla, el pipeline se detiene mostrando el paso exacto.\nEste pipeline es √∫til‚Ä¶\nPorque evita una gran cantidad de pasos manuales que normalmente dispersan tiempo y energ√≠a.\nEvita errores humanos.\nHace el an√°lisis reproducible.\nPermite reanalizar nuevas ventanas cambiando solo un comando.\nProduce figuras de calidad publicable sin intervenci√≥n manual.\nSirve como ‚Äúplantilla‚Äù para futuros proyectos similares.\nPara m√≠ se convirti√≥ en una herramienta esencial dentro del trabajo QM/MM con enzimas.\nDescarga de los scripts\nHe subido los archivos del pipeline a un repositorio de GitHub.\nLa idea es que puedas clonar el repo, adaptar un par de rutas y usarlo como base para tu propio sistema.\nüîó Repositorio completo del pipelinehttps://github.com/camilofm/C3/tree/main/_posts/umbrella_pipeline\nCierre\nEsta versi√≥n del pipeline ya es estable y la utilizo muy seguido.\nSi la adoptas, si√©ntete libre de modificarla, optimizarla o adaptarla a tus propios sistemas.\nY si quieres conversar sobre an√°lisis QM/MM, Umbrella Sampling, TREK o rutas de reacci√≥n, siempre ser√° un gusto.\nCamilo\n\n\n\n",
    "preview": "posts/umbrella_pipeline/US_RC_overlap_np.png",
    "last_modified": "2025-11-28T18:00:31-03:00",
    "input_file": "umbrella_pipeline_blog.knit.md"
  },
  {
    "path": "posts/qmmm/",
    "title": "QM/MM: La Fusi√≥n de lo Cu√°ntico y Molecular",
    "description": "Descubre c√≥mo la combinaci√≥n de Mec√°nica Cu√°ntica y Molecular permite estudiar reacciones qu√≠micas complejas, como las que ocurren en enzimas, logrando una precisi√≥n a nivel cu√°ntico que antes era inalcanzable en sistemas de gran tama√±o.",
    "author": [
      {
        "name": "Dr. Camilo Febres-Molina",
        "url": "https://github.com/camilofm"
      }
    ],
    "date": "2024-11-24",
    "categories": [],
    "contents": "\n\n\n\nPerspectiva General\nEn el campo de la Qu√≠mica Computacional, vamos a hablar sobre un tema fascinante: los c√°lculos QM/MM (Quantum Mechanics/Molecular Mechanics). Esta t√©cnica h√≠brida combina m√©todos mecano-cu√°nticos y mec√°nica molecular, lo que permite estudiar sistemas grandes de manera eficiente.\nA lo largo de este post, utilizaremos como ejemplo una prote√≠na con un ligando cualesquiera, pero ten en cuenta que tambi√©n es posible realizar c√°lculos QM/MM en diversas mol√©culas para distintas aplicaciones, como materiales org√°nicos, complejos met√°licos, f√°rmacos y muchos tipos de sistemas catal√≠ticos. Adem√°s, mencionar√© brevemente el uso de Teor√≠a del Funcional de la Densidad (DFT), una metodolog√≠a com√∫n en los c√°lculos QM que se utiliza para describir con precisi√≥n la densidad electr√≥nica de los sistemas.\nEn este post, te guiar√© desde el principio para que puedas comprender los conceptos b√°sicos y c√≥mo funciona esta metodolog√≠a en general. Adem√°s, por medio de un ejemplo ilustrar√© los pasos fundamentales de esta poderosa herramienta que te ser√° de utilidad incluso si est√°s empezando en el mundo de la qu√≠mica computacional.\n¬°Espero que disfrutes este viaje hacia la comprensi√≥n de una de las t√©cnicas m√°s √∫tiles y emocionantes en el estudio de biomol√©culas!\nComencemos con lo fundamental: ¬øQu√© es QM/MM?\nEl enfoque QM/MM combina dos metodolog√≠as, Mec√°nica Cu√°ntica (QM) y Mec√°nica Molecular (MM), ambas de gran importancia para entender la din√°mica de sistemas complejos:\nMec√°nica Cu√°ntica (QM): Se utiliza para modelar una parte del sistema donde los efectos cu√°nticos son importantes, como en la reacci√≥n qu√≠mica de un sitio activo de una enzima. Aqu√≠, se consideran expl√≠citamente las rupturas y formaciones de enlaces qu√≠micos, lo cual es esencial para describir reacciones qu√≠micas de manera precisa. Por ejemplo, en una enzima, los enlaces del sustrato pueden romperse o formarse durante la reacci√≥n, y estos cambios solo pueden describirse con precisi√≥n utilizando la mec√°nica cu√°ntica, ya que implican la redistribuci√≥n de densidad electr√≥nica (la distribuci√≥n de los electrones en el espacio) y la creaci√≥n de nuevos estados electr√≥nicos (como la formaci√≥n de nuevos enlaces). En este contexto, la Teor√≠a del Funcional de la Densidad (DFT) es una t√©cnica ampliamente utilizada que permite describir la densidad electr√≥nica de manera eficiente y con un buen equilibrio entre precisi√≥n y costo computacional.\nMec√°nica Molecular (MM): Debido al costo computacional elevado en el c√°lculo QM, se usa la mec√°nica molecular para el resto del sistema, que generalmente incluye una gran cantidad de √°tomos (como un solvente o el resto de la prote√≠na), de manera menos costosa computacionalmente. La mec√°nica molecular se encarga de modelar las interacciones de corto y largo alcance de estos √°tomos mediante potenciales cl√°sicos. Las interacciones de corto alcance incluyen fuerzas como las repulsivas y atractivas de Van der Waals, mientras que las de largo alcance comprenden interacciones electrost√°ticas. Para tratar estas interacciones de largo alcance de manera eficiente, se utilizan algoritmos como el PME (Particle Mesh Ewald), que permite calcular las fuerzas electrost√°ticas con alta precisi√≥n, incluso para sistemas muy grandes.\nEn el contexto de la qu√≠mica computacional, este enfoque permite reducir los requisitos de recursos al tiempo que mantiene la precisi√≥n para estudiar la parte m√°s relevante del sistema.\n¬øC√≥mo se realiza un c√°lculo QM/MM?\nPara realizar un c√°lculo QM/MM, es necesario utilizar un software especializado que permita combinar ambos enfoques, el cu√°ntico y el molecular. Generalmente, se elige un software que se adapte bien a la naturaleza del sistema y que sea compatible con los m√©todos h√≠bridos. Para comprender mejor el procedimiento, y como mencion√© al inicio, colocar√© un ejemplo de c√°lculo y metodolog√≠a para el an√°lisis de una prote√≠na y un ligando utilizando la interfaz Qchem-CHARMM, que permite realizar c√°lculos QM/MM de manera eficiente. Qchem se encarga de la parte cu√°ntica, donde se modelan las reacciones y los procesos que involucran cambios en los enlaces qu√≠micos, mientras que CHARMM se encarga de la parte molecular, proporcionando el contexto completo de la prote√≠na o del sistema en su totalidad.\nPrimero, se debe definir qu√© parte del sistema ser√° tratada con QM (generalmente el sitio activo o la regi√≥n de inter√©s donde ocurre una reacci√≥n) y qu√© parte se tratar√° con MM (el resto del sistema, como la prote√≠na y el solvente). Luego, se configura la simulaci√≥n con los par√°metros adecuados para cada m√©todo, y se ejecuta la simulaci√≥n utilizando la interfaz Qchem-CHARMM para integrar ambas partes del c√°lculo.\nPara ilustrar mejor esta combinaci√≥n de ambas zonas, a continuaci√≥n se muestra la imagen de un sistema proteico y su ligando, resaltando la regi√≥n QM (el sitio activo), mientras que el resto del sistema es tratado con MM indicando su contribuci√≥n al c√°lculo. Esto ayudar√° a visualizar c√≥mo se dividen las regiones y cu√°l es el enfoque general de cada una.\nDebido a la gran diversidad de sistemas, enzimas y reacciones, no existe una ‚Äòreceta general‚Äô para los c√°lculos QM/MM. En este post, a modo de ejemplo, se presentar√° una forma de proceder, que es la que, personalmente yo, utilizo habitualmente en mis investigaciones.\n√âsta incluye los siguientes pasos: optimizaciones geom√©tricas, exploraci√≥n de la energ√≠a potencial, b√∫squeda del camino de m√≠nima energ√≠a, an√°lisis de los resultados, y an√°lisis de la energ√≠a y la estructura.\nPasos Generales\nOptimizaci√≥n geom√©trica: Se realiza una optimizaci√≥n de la estructura utilizando primero solo MM y luego una combinaci√≥n QM/MM para ajustar las regiones de inter√©s con precisi√≥n cu√°ntica.\nExploraci√≥n de coordenada de reacci√≥n: Se lleva a cabo un ‚Äúscan‚Äù, que consiste en optimizaciones geom√©tricas a lo largo de una coordenada de reacci√≥n (RC). Esta coordenada de reacci√≥n se define mediante una combinaci√≥n de distancias entre √°tomos y permite mapear c√≥mo cambia la energ√≠a a medida que ocurre la reacci√≥n.\nB√∫squeda del camino de m√≠nima energ√≠a: Una vez que se obtiene la trayectoria inicial a lo largo de la coordenada de reacci√≥n, se utiliza el algoritmo CPR (Conjugate Peak Refinement) implementado en el m√≥dulo TREK del software CHARMM para encontrar el camino de m√≠nima energ√≠a. Este proceso permite identificar un camino adiab√°tico de m√≠nima energ√≠a (es decir, un camino en el que no se intercambia calor con el entorno) que conecte reactantes con productos. As√≠ como tambi√©n, el CPR logra identificar uno o m√°s estados de transici√≥n (TS) verdaderos.\nC√°lculo de energ√≠a puntual (single point energy): Seguidamente, se realiza un c√°lculo de energ√≠a puntual (single point energy) en los tres estados principales de la reacci√≥n: el reactante, el estado de transici√≥n (TS), y el producto. Esto se hace con un nivel de teor√≠a mucho mejor (un modelo m√°s preciso para describir el sistema cu√°ntico) para recalcular las energ√≠as en estos tres puntos y mejorar los resultados de la barrera de energ√≠a asociada a la reacci√≥n.\nAn√°lisis de los resultados: Se realiza un an√°lisis general de los resultados obtenidos. Esto incluye:\nAn√°lisis estructural o geom√©trico: Se examinan las estructuras optimizadas de los puntos estacionarios (reactante, estado de transici√≥n y producto) para identificar cambios importantes en las geometr√≠as a lo largo de la reacci√≥n.\n\n\nGr√°fico que muestra los tres puntos estacionarios de la reacci√≥n por la que pasa el camino de m√≠nima energ√≠a: el reactivo (R), el estado de transici√≥n (TS) y el producto (P). [¬ß]\nDiagramas de energ√≠a: Se analizan los perfiles de energ√≠a para identificar la barrera energ√©tica asociada a la reacci√≥n y evaluar su viabilidad.\n\nPerfil de energ√≠a potencial vs una coordenada de reacci√≥n del ‚Äúscan‚Äù. Esta es una aproximaci√≥n inicial que nos permitir√° a continuaci√≥n encontrar el camino de m√≠nima energ√≠a. [¬ß]\n\n\n\n\nC√°lculo de energ√≠a puntual (single point energy, en ingl√©s) de los puntos estacionarios. Se muestra la barrera o energ√≠a de activaci√≥n (8.8 kcal/mol) de la reacci√≥n catalizada por la enzima. [¬ß]\nAn√°lisis NBO (Natural Bond Orbital): Se investigan las cargas de los puntos estacionarios de la reacci√≥n para entender la distribuci√≥n de la carga electr√≥nica y c√≥mo esta influye en la reactividad del sistema.\n\nEstado de transici√≥n de la reacci√≥n donde se muestran zonas coloreadas que indican las principales interacciones entre los √°tomos relacionados a la reactividad. [¬ß]\nConclusi√≥n:\nEn resumen, el enfoque QM/MM nos permite estudiar sistemas complejos de manera eficiente, combinando la precisi√≥n de la mec√°nica cu√°ntica con la versatilidad y menor costo computacional de la mec√°nica molecular. A trav√©s de los pasos descritos ‚Äîdesde la optimizaci√≥n geom√©trica hasta el an√°lisis de resultados‚Äî, es posible entender en detalle el mecanismo de reacci√≥n de biomol√©culas y sistemas catal√≠ticos. Los resultados obtenidos, integrando an√°lisis energ√©ticos, NBO y estructurales, nos brindan una visi√≥n completa del proceso reactivo, la cual puede ser comparada con otros sistemas similares para validar nuestras conclusiones. Esta poderosa metodolog√≠a h√≠brida ha demostrado ser una herramienta fundamental para desentra√±ar los complejos y diferentes mecanismos catal√≠ticos enzim√°ticos, proporcionando informaci√≥n clave que puede guiar futuras investigaciones.\n\n\n\nEs importante recalcar que todo lo presentado en este post es solo una de las varias maneras de realizar un c√°lculo QM/MM, y que los pasos presentados aqu√≠ reflejan un ejemplo espec√≠fico basado en mi experiencia de trabajo.\n\n\n\nNota a pie de p√°gina\n[¬ß] Las imagenes colocadas en este post sirven como ejemplos ilustrativos de una de las maneras en las que se puede trabajar con el m√©todo QM/MM.\nPara mayor informaci√≥n revisar el art√≠culo publicado en la revista Organic & Biomolecular Chemistry ‚Ä†.\nReferencia\n‚Ä†Febres-Molina, Camilo; Prat-Resina, Xavier; Ja√±a, Gonzalo A. 2023. ‚ÄúResveratrol Glucosylation by GTF-SI from Streptococcus Mutans: Computational Insights into a GH70 Family Enzyme.‚Äù Organic & Biomolecular Chemistry 21 (48): 9591‚Äì9602.\n\n\n\n",
    "preview": "posts/qmmm/qm-mm_white-bg.png",
    "last_modified": "2024-11-24T02:19:26-03:00",
    "input_file": "qmmm.knit.md"
  },
  {
    "path": "posts/AIM/",
    "title": "La Teor√≠a de √Åtomos en Mol√©culas (AIM - en Ingl√©s)",
    "description": "La Teor√≠a de √Åtomos en Mol√©culas (AIM) es una herramienta poderosa creada por Richard F. W. Bader en los a√±os 70 y 80. Esta teor√≠a redefine c√≥mo vemos los √°tomos en una mol√©cula usando la densidad electr√≥nica. Identificando puntos cr√≠ticos y superficies de cero flujo, AIM desentra√±a c√≥mo los √°tomos interact√∫an dentro de las mol√©culas, revolucionando nuestra comprensi√≥n de la estructura y reactividad qu√≠mica.  \n¬°Una joya para la qu√≠mica te√≥rica y computacional!",
    "author": [
      {
        "name": "Camilo Febres-Molina",
        "url": "https://github.com/camilofm"
      }
    ],
    "date": "2024-07-06",
    "categories": [],
    "contents": "\n\n\n\nLa Teor√≠a de √Åtomos en Mol√©culas (Atoms In Molecules, AIM - en Ingl√©s)\nOr√≠genes y Desarrollo\nDurante las d√©cadas de 1970 y 1980, Richard F. W. Bader, un destacado qu√≠mico cu√°ntico canadiense, desarroll√≥ la revolucionaria teor√≠a de ‚Äò√Åtomos en Mol√©culas‚Äô (AIM). Bader, tras completar su licenciatura y maestr√≠a en McMaster University, obtuvo su doctorado en el MIT en 1958. Durante su carrera acad√©mica en la University of Ottawa y posteriormente en McMaster University, Bader se dedic√≥ a encontrar una forma precisa y rigurosa de definir los √°tomos dentro de una mol√©cula.\n\n\n\n\nRichard F. W. Bader - septiembre 2009\n\n(CNCC 2009)\nDesarrollo de AIM\nEn su b√∫squeda de esta definici√≥n, Bader observ√≥ que la densidad electr√≥nica, œÅ(r), podr√≠a ser utilizada para delimitar regiones at√≥micas dentro de una mol√©cula. Esta observaci√≥n fue el punto de partida para el desarrollo de la teor√≠a AIM, que se basa en el an√°lisis topol√≥gico de la densidad electr√≥nica. La teor√≠a establece que los √°tomos en una mol√©cula se pueden identificar y definir mediante la topolog√≠a de su densidad electr√≥nica.\nLa Historia de la Teor√≠a AIM\nLos Primeros A√±os: Definiendo el √Åtomo\nEn los a√±os 70, Bader y su equipo comenzaron a explorar c√≥mo la densidad electr√≥nica podr√≠a utilizarse para definir las regiones at√≥micas dentro de una mol√©cula. Descubrieron que la topolog√≠a de la densidad electr√≥nica ofrec√≠a una forma natural de dividir una mol√©cula en √°tomos.\nConceptos Clave:\nDensidad Electr√≥nica (œÅ(r)): La densidad electr√≥nica en un punto r describe la probabilidad de encontrar un electr√≥n en esa posici√≥n.\n\\[\n\\rho(\\mathbf{r}) = \\sum_{i=1}^N |\\psi_i(\\mathbf{r})|^2\n\\]\nEsta ecuaci√≥n muestra la densidad electr√≥nica, donde \\(\\psi_i(\\mathbf{r})\\) son las funciones de onda de los electrones y \\(\\mathbf{r}\\) es el vector posici√≥n.\nLa densidad electr√≥nica es importante para definir c√≥mo se distribuyen los electrones alrededor de los n√∫cleos at√≥micos en una mol√©cula.\nGradiente de Densidad Electr√≥nica (‚àáœÅ(r)): El gradiente de la densidad electr√≥nica, que es la primera derivada parcial de la densidad electr√≥nica, indica la direcci√≥n de mayor cambio en la densidad.\n\\[\n\\nabla \\rho(\\mathbf{r}) = \\left( \\frac{\\partial \\rho}{\\partial x}, \\frac{\\partial \\rho}{\\partial y}, \\frac{\\partial \\rho}{\\partial z} \\right)\n\\]\nEl gradiente de densidad electr√≥nica es fundamental para identificar las superficies de interacci√≥n at√≥mica, ya que muestra c√≥mo cambia la densidad en diferentes direcciones.\nPrincipios AIM\nBas√°ndose en la topolog√≠a de la densidad electr√≥nica, la teor√≠a AIM proporciona una manera precisa de identificar y definir los √°tomos y sus interacciones dentro de una mol√©cula. Esta teor√≠a permite el an√°lisis detallado de la estructura molecular a trav√©s de los puntos cr√≠ticos de la densidad electr√≥nica y las regiones mononucleares (\\(\\Omega\\)).\nPuntos Cr√≠ticos:\nLos puntos cr√≠ticos son lugares en el espacio donde el gradiente de la densidad electr√≥nica es cero, es decir, donde no hay cambio en la densidad en ninguna direcci√≥n. Esto significa que en estos puntos, la densidad electr√≥nica es extrema (m√°xima o m√≠nima) o tiene un comportamiento de silla de montar.\nEstos puntos se clasifican seg√∫n la curvatura de la densidad electr√≥nica en esas posiciones. Los n√∫meros entre par√©ntesis (3,-3), (3,-1), (3,+1), (3,+3) se refieren a la naturaleza del punto cr√≠tico:\nEl primer n√∫mero (3) indica el n√∫mero de dimensiones en las cuales se puede describir la densidad electr√≥nica.\nEl segundo n√∫mero (-3, -1, +1, +3) describe el tipo de punto cr√≠tico, especificando el n√∫mero de direcciones en las que la densidad electr√≥nica es un m√°ximo (-) o un m√≠nimo (+).\n\nN√∫cleo (3,-3): M√°ximos locales de densidad que corresponden a los n√∫cleos de los √°tomos. Indican la posici√≥n del n√∫cleo en el espacio.\nEnlace (3,-1): Puntos de silla que indican la existencia de enlaces qu√≠micos. Estos puntos se encuentran entre n√∫cleos de √°tomos y son indicativos de la presencia de un enlace.\nPlano (3,+1) y Jaula (3,+3): M√≠nimos locales de densidad que se relacionan con estructuras tridimensionales m√°s complejas dentro de la mol√©cula.\n\nSuperficies de Interacci√≥n At√≥mica:\nLos √°tomos en una mol√©cula est√°n delimitados por superficies de flujo cero (\\(S(\\Omega)\\)) en el campo vectorial del gradiente de la densidad electr√≥nica, \\(\\nabla \\rho(\\mathbf{r})\\). Estas superficies no son cruzadas por ning√∫n vector de gradiente de la densidad electr√≥nica, lo que equivale a satisfacer la condici√≥n:\n\n\\[\n\\nabla \\rho(\\mathbf{r}) \\cdot \\mathbf{n}(\\mathbf{r}) = 0, \\quad \\text{para toda } \\mathbf{r} \\in S(\\Omega)\n\\]\ndonde \\(\\mathbf{r}\\) es el vector de posici√≥n y \\(\\mathbf{n}(\\mathbf{r})\\) es el vector unitario normal a la superficie \\(S(\\Omega)\\). Esta condici√≥n define claramente los l√≠mites de los √°tomos dentro de una mol√©cula.\nPublicaci√≥n y Reconocimiento\nEn 1981, Bader public√≥ su teor√≠a en el libro ‚ÄúAtoms in Molecules: A Quantum Theory‚Äù (Bader and Nguyen-Dang 1981). Aunque inicialmente encontr√≥ resistencia, su teor√≠a eventualmente gan√≥ aceptaci√≥n y se convirti√≥ en una herramienta fundamental en la qu√≠mica te√≥rica y computacional.\nAplicaciones de AIM\nOptimizaci√≥n de Geometr√≠as\nLa teor√≠a AIM permite definir √°tomos y estudiar sus interacciones dentro de una mol√©cula, mejorando as√≠ la comprensi√≥n de la optimizaci√≥n de geometr√≠as moleculares y la naturaleza de los enlaces qu√≠micos.\nAn√°lisis de Enlaces\nLos puntos cr√≠ticos de enlace (BCP) son esenciales para caracterizar y entender enlaces covalentes, i√≥nicos y no covalentes. La densidad electr√≥nica en estos puntos y su curvatura proporcionan informaci√≥n crucial sobre la fuerza y naturaleza del enlace. La densidad en un BCP es dada por:\n\\[\n\\rho_{\\text{BCP}} = \\rho(\\mathbf{r}_{\\text{BCP}})\n\\]\nEsta densidad proporciona informaci√≥n sobre la estabilidad y la naturaleza del enlace qu√≠mico.\nDin√°mica Molecular y Simulaciones\nAIM se integra en muchos paquetes de software de qu√≠mica computacional, permitiendo realizar an√°lisis topol√≥gicos de densidad electr√≥nica en simulaciones de din√°mica molecular.\nEjemplo Ilustrativo: El Agua (H‚ÇÇO)\nC√°lculo de Densidad Electr√≥nica:\nUtilizamos un m√©todo como la DFT para calcular la densidad electr√≥nica de H‚ÇÇO.\nIdentificaci√≥n de Puntos Cr√≠ticos:\nEncontramos puntos cr√≠ticos en los n√∫cleos de ox√≠geno e hidr√≥geno (3,-3) y puntos cr√≠ticos de enlace (3,-1) entre el ox√≠geno y cada hidr√≥geno.\nAn√°lisis de Enlaces:\nLa densidad en los puntos cr√≠ticos de enlace nos dice sobre la naturaleza covalente del enlace O-H.\nDefinici√≥n de √Åtomos:\nLas superficies de cero flujo delimitan el ox√≠geno y los hidr√≥genos, permitiendo calcular propiedades como la carga at√≥mica integrando sobre estas regiones. La ecuaci√≥n para la densidad en un punto cr√≠tico de enlace es:\n\\[\n\\left. \\frac{\\partial \\rho}{\\partial x_i} \\right|_{\\text{BCP}} = 0 \\quad \\forall i\n\\]\nEsta ecuaci√≥n indica que el gradiente de densidad electr√≥nica en el punto cr√≠tico de enlace (BCP) es cero en todas las direcciones, lo que define claramente la regi√≥n del enlace y permite analizar sus propiedades.\nImpacto de AIM\nAIM ha tenido un impacto profundo en la qu√≠mica te√≥rica y computacional. Su enfoque riguroso y matem√°tico ha proporcionado una base s√≥lida para estudios de estructura electr√≥nica, reactividad qu√≠mica y dise√±o de materiales.\n\n\n\nBader, Richard FW, and TT Nguyen-Dang. 1981. Quantum Theory of Atoms in Molecules‚ÄìDalton Revisited. Vol. 14. Elsevier.\n\n\nCNCC. 2009. ‚ÄúPhoto Credit: Canadian National Committee for Crystallography Newsletter No 1.‚Äù\n\n\n\n\n",
    "preview": "posts/AIM/pictures/aim.png",
    "last_modified": "2024-07-07T16:01:22-04:00",
    "input_file": {}
  },
  {
    "path": "posts/us_scripts_files/",
    "title": "Scripts en Bash para realizar c√°lculos Umbrella Sampling (QM/MM MD)",
    "description": "En este post presento dos scripts que sirven para generar los archivos de entrada para poder correr c√°lculos de Umbrella Sampling en sistemas prote√≠na-ligando y utilizando la interfaz CHARMM-Gaussian, dado que el nivel de teor√≠a a utilizar ser√° SCC-DFTB/CHARMM.",
    "author": [
      {
        "name": "Camilo Febres-Molina",
        "url": "https://github.com/camilofm"
      }
    ],
    "date": "2022-09-20",
    "categories": [],
    "contents": "\n\n\n\nIndicaciones iniciales\nLos siguientes dos scripts en Bash requieren de otros archivos en los que les proporcionaremos las ventanas de simulaci√≥n, los frames que corresponden a dichas ventanas de simulaci√≥n, los archivos ‚Äòinput‚Äô plantilla para enviar los c√°lculos a CHARMM, y finalmente, los archivos ‚Äòinput‚Äô que generar√°n otros archivos necesarios para las din√°micas QM/MM.\nPor lo tanto, los archivos que deben estar en la misma direcci√≥n para lograr generar satisfactoriamente las carpetas con los archivos de entrada correspondientes a cada una de las ventanas negativas y positivas son los siguientes:\n01-create_conf-cfm.sh; ¬† ¬† ¬† <‚Äì Los scripts\n02-create_us_eq-cfm.sh;\nnegative_rc.txt; ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† ¬† <‚Äì Y los archivos extras\npositive_rc.txt;\ntraj_frames_neg.txt;\ntraj_frames_pos.txt\nconf_template.inp;\nus_eq_template.inp;\nmakenew_cns.inp;\nmakenew_reg.inp;\nScripts y archivos extra\n01-create_conf-cfm.sh:\n#!/bin/bash\n\n### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###\n###                                                             ###\n###   This script creates configure files for PMF calculation   ###\n###        Run this script before 02-create_us_eq-cfm.sh        ###\n###       Needs the following things in the same directory:     ###\n###               negative_rc.txt, traj_frames_*.txt,           ###\n###                conf_template.inp, makenew_*inp,             ###\n###                        positive_rc.txt                      ###\n###        (Remember to address the .crd, .psf, .dcd &          ###\n###         parameters files in the conf_template file)         ###\n###   Note: There is a part (mentioned below) that must be      ###\n###         adapted to the number of RC & trajectory frames     ###\n###         of your system.                                     ###\n###   by CFM                                                    ###\n\n### First part: negative RC ###  \n\n#creating negative RC directories & conf_nX.inp files within\ncat negative_rc.txt | while read rc\ndo\n   mkdir n$rc\n   echo \"n$rc directory created ...\"\n   sed -e \"s|RRR|n$rc|g\" conf_template.inp > n$rc/conf_n$rc.inp # changes input & output\n   echo \"n$rc/conf_n$rc.inp file created ...\"\ndone\n\n#generating a temporary file 'rc_tr-neg.txt' to use each number later\ncat negative_rc.txt >> rc_tr-neg.txt\ncat traj_frames_neg.txt >> rc_tr-neg.txt\necho \"rc_tr-neg.txt temporary file created ...\"\n\n#!!! This part must be adapted to the number of RC & trajectory frames of your system !!!#\n#reading RC\nread rc1 < <(sed -n 1p rc_tr-neg.txt)\nread rc2 < <(sed -n 2p rc_tr-neg.txt)\nread rc3 < <(sed -n 3p rc_tr-neg.txt)\nread rc4 < <(sed -n 4p rc_tr-neg.txt)\nread rc5 < <(sed -n 5p rc_tr-neg.txt)\nread rc6 < <(sed -n 6p rc_tr-neg.txt)\nread rc7 < <(sed -n 7p rc_tr-neg.txt)\nread rc8 < <(sed -n 8p rc_tr-neg.txt)\n\n#reading trajectory frames\nread fr1 < <(sed -n 9p rc_tr-neg.txt)\nread fr2 < <(sed -n 10p rc_tr-neg.txt)\nread fr3 < <(sed -n 11p rc_tr-neg.txt)\nread fr4 < <(sed -n 12p rc_tr-neg.txt)\nread fr5 < <(sed -n 13p rc_tr-neg.txt)\nread fr6 < <(sed -n 14p rc_tr-neg.txt)\nread fr7 < <(sed -n 15p rc_tr-neg.txt)\nread fr8 < <(sed -n 16p rc_tr-neg.txt)\n\n#correlating each frame of trajectory with its appropriate RC conf file\nsed -i \"s|TTT|$fr1|g\" n$rc1/conf_n$rc1.inp\necho \"n$rc1/conf_n$rc1.inp file correctly correlated ...\"\nsed -i \"s|TTT|$fr2|g\" n$rc2/conf_n$rc2.inp\necho \"n$rc2/conf_n$rc2.inp file correctly correlated ...\"\nsed -i \"s|TTT|$fr3|g\" n$rc3/conf_n$rc3.inp\necho \"n$rc3/conf_n$rc3.inp file correctly correlated ...\"\nsed -i \"s|TTT|$fr4|g\" n$rc4/conf_n$rc4.inp\necho \"n$rc4/conf_n$rc4.inp file correctly correlated ...\"\nsed -i \"s|TTT|$fr5|g\" n$rc5/conf_n$rc5.inp\necho \"n$rc5/conf_n$rc5.inp file correctly correlated ...\"\nsed -i \"s|TTT|$fr6|g\" n$rc6/conf_n$rc6.inp\necho \"n$rc6/conf_n$rc6.inp file correctly correlated ...\"\nsed -i \"s|TTT|$fr7|g\" n$rc7/conf_n$rc7.inp\necho \"n$rc7/conf_n$rc7.inp file correctly correlated ...\"\nsed -i \"s|TTT|$fr8|g\" n$rc8/conf_n$rc8.inp\necho \"n$rc8/conf_n$rc8.inp file correctly correlated ...\"\n\nrm rc_tr-neg.txt\n#!!! !!! !!! !!! !!! !!! !!! !!! !!! !!!  !!! !!! !!! !!! !!! !!! !!! !!! !!! !!! !!! !!!#\n\n#copying some relevant files down to the nRC directories & executing the conf file\ncat negative_rc.txt | while read rc\ndo\n   cp makenew_*inp n$rc/\n   cp -r toppar* n$rc/ #copying parameters file & directory for the protein\n   cp -r 7kp/ n$rc/ #copying parameters directory for the ligand\n   echo \"Relevant files copied down to n$rc/ directory ...\"\n   echo \"Executing n$rc/conf_n$rc.inp file in charmm...\"\n   cd n$rc\n   /opt/charmm-45b2/exec/gnu_M/charmm < conf_n$rc.inp > conf_n$rc.out\n   cd ..\ndone\n\n###   Second part: positive RC ###\n\n#creating positive RC directories & conf_pX.inp files within\ncat positive_rc.txt | while read rc\ndo\n   mkdir p$rc\n   echo \"p$rc directory created ...\"\n   sed -e \"s|RRR|p$rc|g\" conf_template.inp > p$rc/conf_p$rc.inp # changes input & output\n   echo \"p$rc/conf_p$rc.inp file created ...\"\ndone\n\n#generating a temporary file 'rc_tr-pos.txt' to use each number later\ncat positive_rc.txt >> rc_tr-pos.txt\ncat traj_frames_pos.txt >> rc_tr-pos.txt\necho \"rc_tr-pos.txt temporary file created ...\"\n\n#!!! This part must be adapted to the number of RC & trajectory frames of your system !!!#\n#reading RC\nread rc1 < <(sed -n 1p rc_tr-pos.txt)\nread rc2 < <(sed -n 2p rc_tr-pos.txt)\nread rc3 < <(sed -n 3p rc_tr-pos.txt)\nread rc4 < <(sed -n 4p rc_tr-pos.txt)\nread rc5 < <(sed -n 5p rc_tr-pos.txt)\nread rc6 < <(sed -n 6p rc_tr-pos.txt)\nread rc7 < <(sed -n 7p rc_tr-pos.txt)\nread rc8 < <(sed -n 8p rc_tr-pos.txt)\n\n#reading trajectory frames\nread fr1 < <(sed -n 9p rc_tr-pos.txt)\nread fr2 < <(sed -n 10p rc_tr-pos.txt)\nread fr3 < <(sed -n 11p rc_tr-pos.txt)\nread fr4 < <(sed -n 12p rc_tr-pos.txt)\nread fr5 < <(sed -n 13p rc_tr-pos.txt)\nread fr6 < <(sed -n 14p rc_tr-pos.txt)\nread fr7 < <(sed -n 15p rc_tr-pos.txt)\nread fr8 < <(sed -n 16p rc_tr-pos.txt)\n\n#correlating each frame of trajectory with its appropriate RC conf file\nsed -i \"s|TTT|$fr1|g\" p$rc1/conf_p$rc1.inp\necho \"p$rc1/conf_p$rc1.inp file correctly correlated ...\"\nsed -i \"s|TTT|$fr2|g\" p$rc2/conf_p$rc2.inp\necho \"p$rc2/conf_p$rc2.inp file correctly correlated ...\"\nsed -i \"s|TTT|$fr3|g\" p$rc3/conf_p$rc3.inp\necho \"p$rc3/conf_p$rc3.inp file correctly correlated ...\"\nsed -i \"s|TTT|$fr4|g\" p$rc4/conf_p$rc4.inp\necho \"p$rc4/conf_p$rc4.inp file correctly correlated ...\"\nsed -i \"s|TTT|$fr5|g\" p$rc5/conf_p$rc5.inp\necho \"p$rc5/conf_p$rc5.inp file correctly correlated ...\"\nsed -i \"s|TTT|$fr6|g\" p$rc6/conf_p$rc6.inp\necho \"p$rc6/conf_p$rc6.inp file correctly correlated ...\"\nsed -i \"s|TTT|$fr7|g\" p$rc7/conf_p$rc7.inp\necho \"p$rc7/conf_p$rc7.inp file correctly correlated ...\"\nsed -i \"s|TTT|$fr8|g\" p$rc8/conf_p$rc8.inp\necho \"p$rc8/conf_p$rc8.inp file correctly correlated ...\"\n\nrm rc_tr-pos.txt\n#!!! !!! !!! !!! !!! !!! !!! !!! !!! !!!  !!! !!! !!! !!! !!! !!! !!! !!! !!! !!! !!! !!!#\n\n#copying some relevant files down to the pRC directories & executing the conf file\ncat positive_rc.txt | while read rc\ndo\n   cp makenew_*inp p$rc/\n   cp -r toppar* p$rc/ #copying parameters file & directory for the protein\n   cp -r 7kp/ p$rc/ #copying parameters directory for the ligand\n   echo \"Relevant files copied down to p$rc/ directory ...\"\n   echo \"Executing p$rc/conf_p$rc.inp file in charmm...\"\n   cd p$rc\n   /opt/charmm-45b2/exec/gnu_M/charmm < conf_p$rc.inp > conf_p$rc.out\n   cd ..\ndone\n\necho \"Done.\"\n\n###                                                             ###\n###                       End of this script                    ###\n###                                                             ###\n### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###\n02-create_us_eq-cfm.sh:\n#!/bin/bash\n\n### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###\n###                                                             ###\n###  This script creates equilibration files for US - QM/MM MD  ###\n###             Run this after 01-create_conf-cfm.sh            ###\n###            Additionally needs the following files           ###\n###                      in the same directory:                 ###\n###                 us_eq_template.inp, sccdftb.dat             ###\n###          (Remember to define your qm zone, charge &         ###\n###         other parameters in the us_eq_template file)        ###\n###   by CFM                                                    ###\n\n### First part: negative RC ###  \n\n#creating the eq_nX.inp file & copying sccdftb.dat file\ncat negative_rc.txt | while read rc\ndo\n   d1=`echo $rc | cut -b 1`\n   d2=`echo $rc | cut -b 2`\n   sed -e \"s|TTT|-$d1.$d2|g\" us_eq_template.inp > n$rc/eq_n$rc.inp   #putting the RC\n   sed -i \"s|RRR|n$rc|g\" n$rc/eq_n$rc.inp   #changing the input & output\n   echo \"n$rc/eq_n$rc.inp file created ...\"\n   cp sccdftb.dat n$rc\ndone\n\n### Second part: positive RC ###\n\n#creating the eq_pX.inp file & copying sccdftb.dat file\ncat positive_rc.txt | while read rc\ndo\n   d1=`echo $rc | cut -b 1`\n   d2=`echo $rc | cut -b 2`\n   sed -e \"s|TTT|$d1.$d2|g\" us_eq_template.inp > p$rc/eq_p$rc.inp   #putting the RC\n   sed -i \"s|RRR|p$rc|g\" p$rc/eq_p$rc.inp   #changing the input & output\n   echo \"p$rc/eq_p$rc.inp file created ...\"\n   cp sccdftb.dat p$rc\ndone\n\necho \"Done.\"\n\n###                                                             ###\n###                       End of this script                    ###\n###                                                             ###\n### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ### ###\nA continuaci√≥n se muestran ejemplos arbitrarios de los archivos extra arriba mencionados:\nnegative_rc.txt:\ntraj_frames_neg.txt:\nconf_template.inp:\n!Configuracion para crear esfera con zonas definidas, para hacer umbrella sampling - example\n\nbomlev -1\nset d .\nset stream ~/utils/stream\nset input RRR\nset output RRR\n\nstream toppar_wo.str\n\nopen read form unit 1 name ~/umbrella/gtfwt_cryst.psf\nREAD psf card unit 1\nclose unit 1\n\nopen read form unit 1 name ~/umbrella/prod.crd\nREAD coord card unit 1\nclose unit 1\n\n! .1define the substrate stereocenter as the origin of coordinates\ndefine cntr1 sele segid HETA .and. type C1 end\n\n! .2moving\ncoor stat sele cntr1 end\ncoor translate xdir -?xave ydir -?yave zdir -?zave sele all end\n\n! .3checking center\ncoor stat sele cntr1 end\n\nopen read unit 3 file name ~/umbrella/path.dcd\nread coord file unit 3 ifile TTT\nclose unit 3\n\ndele atom sele .byres. ( .not. ( point 0.0 0.0 0.0 cut 30.0)) end\n\n!-----------regions\nset xcen     0.0\nset ycen     0.0\nset zcen     0.0\nset rsphere 25.0         ! radius of the spherical region of interest\nset rexcl    2.0         ! water exclusion radius\nset rgeo     4.0         ! to setup the MMFP potential\ncalc rwater  = @rsphere - @rexcl\ncalc rdroff  = @rsphere - @rgeo\nset temp   310.0 !for lang region\n\nstream @stream/writeall.inp\nstream @stream/input.inp\nstream makenew_reg.inp\nstream makenew_cns.inp  \n\nend\nus_eq_template.inp:\n! Equilibrium MD for umbrella sampling - example\n\nbomlev -2\n!----files\nset input RRR\nset output RRR\nset loadcrd  0 !load @restart.crd before any min or md\nset loadres  0 !load @restart.res before any min or md\nset loadpdb  0 !load @restart.res before any min or md\n!set mijinp   1v54.fsph30.mij.25.mij\n!set phiinp   1v54.fsph30.phi\n!----directories\nset d .\nset stream ~/utils/stream\n\n!-----keywords\nset kumb 100.0\nset del0 TTT\n!-----------elec options\nset nbond ext\n!set nbond atcut\n!set polgsbp 25\n!-----------min op\nset minon  0\nset minrun abnr\nset minstep 50\nset minprint 1\nset mintolg 0.01\n!-----------md op\nset mdon  1\nset mdrun  start\n!set mdseed 314159\nset mdtype lang\nset timest 0.001\nset mdstep 10000\nset mdfirst 100\nset mdtemp 310\nset ieqfrq 500.0 !higher than 0.0 for equilibration\n!\n!-----------regions (consistens with regions/constants file)\nset xcen     0.0\nset ycen     0.0\nset zcen     0.0\nset rsphere 25.0         ! radius of the spherical region of interest\nset rexcl    2.0         ! water exclusion radius \nset rgeo     4.0         ! to setup the MMFP potential + Langevin(buffer) zone\ncalc rwater  = @rsphere - @rexcl\ncalc rdroff  = @rsphere - @rgeo\n\nstream toppar_wo.str\n\nstream @stream/input.inp\n\nstream @stream/nbond_atcut.inp\n!set langevin environment\nstream @stream/sbc.inp\n!what is fixed and what moves (consistent with sbc)\n! apply regdef and mmfp altogether\nstream @stream/regdef.inp !fix(3-bonds rule) and scale 0.0 charges\n!cons fix sele resname CU2 end ! CUa is very close to the edge we dont have parameter\nstream @stream/mmfp_sph.inp\n\ndefine asp sele segid PROA .and. resid 477 .and.( .not. (type CA .or. type HA -\n .or. type N .or. type HN .or. type C .or. type O )) end\n\ndefine glup sele segid PROA .and. resid 515 .and.( .not. (type CA .or. type HA - \n .or. type N .or. type HN .or. type C .or. type O )) end\n\ndefine asp2 sele segid PROA .and. resid 588 .and.( .not. (type CA .or. type HA -\n .or. type N .or. type HN .or. type C .or. type O )) end\n\ndefine wo67 sele segid HETB .and. resid 1167 end\n\ndefine wo96 sele segid HETB .and. resid 1196 end\n\ndefine qm sele asp .or. glup .or. segid HETA .or. asp2 .or. wo67 .or. wo96 end\n\nscalar WMAIN set 1.0 sele (qm) .and. type O*  SHOW end\nscalar WMAIN set 2.0 sele (qm) .and. type N*  SHOW end\nscalar WMAIN set 3.0 sele (qm) .and. type C*  SHOW end\nscalar WMAIN set 4.0 sele (qm) .and. type H*  SHOW end\nscalar WMAIN set 4.0 sele (qm) .and. type QQ*  SHOW end\n\nSCCDFTB remove CHRG -2 SELE QM END TEMP 0.00 SCFT 0.00000001  D3RD HBOND\n\n!------Load current geom--\nif loadcrd lt 1 goto noloadcrd\nopen read unit 3 card name @d/@restart.crd\nread coor card unit 3\nclose unit 3\n\nlabel noloadcrd\n!------Load current geom--\nif loadres lt 1 goto noloadres\nopen read unit 3 card name @d/@restart.res\nread coor dynr curr unit 3\nclose unit 3\n\nlabel noloadres\n!------Load current geom--\nif loadpdb lt 1 goto noloadpdb\nopen read unit 3 card name @d/@restart.pdb\nread coor pdb unit 3\nclose unit 3\n\nlabel noloadpdb\n\nopen write unit 3 card name @output.qm.pdb\nwrite coor pdb sele qm end unit 3\nclose unit 3\n\nrxncor: define o1   point sele atom HETA 1 O1 end\nrxncor: define c1   point sele atom HETA 1 C1 end\nrxncor: define oasp point sele atom PROA 477 OD1 end\nrxncor: define a3   dist o1 c1\nrxncor: define a4   dist c1 oasp\n\nrxncor: define RC combin a3 1.0 a4 -1.0\nrxncor: set nrxn 1 RC\n\nopen unit 29 form write name  @d/@output.rc\n\nrxncor: trace RC unit 29\n\nrxncor: umbrella name RC kumb @kumb del0 @del0 form 1 \nrxncor: statistics name RC lowdelta -1.7 hidelta 1.5 deldel 0.1 start 1000\n!energy\n!-------MIN -------------\nif minon lt 1 goto nomin\n!open write unit 11 uform name @output.min.dcd\n!mini @minrun nstep @minstep nprint @minprint tolg @mintolg iuncrd 11 nsavc 3\nmini @minrun nstep @minstep nprint @minprint tolg @mintolg\n\nlabel nomin\n\nif mdon lt 1 goto nomd\n!shake bonh tolerance 1.0e-06 MXIT 1500\n\nopen unit 24 form read  name @d/@restart.res\nopen unit 25 form write name @d/@output.res\nopen unit 26 file write name @d/@output.dcd\nopen unit 21 form write name @d/@output.static \n\ndynamics @mdtype @mdrun timestep @timest nstep @mdstep nprint 10 iprfrq 500 -\n    firstt @mdfirst finalt @mdtemp tstruc @mdtemp TEMINC 5.0 twindl -10.0 twindh 10.0 -\n    IHTFRQ 0 IEQFRQ @ieqfrq NTRFRQ 0 ISVFRQ 100 -\n    IASORS 0 IASVEL 1 ISCVEL 0 ICHECW 0 ISEED iseed -\n    iunrea 24 iunwri 25 iuncrd 26 iunvel -1 kunit 20 nsavc 100 nsavv 0 -\n    inbfrq -1 imgfrq 0 ilbfrq -1 ihbfrq 0 tbath @mdtemp rbuffer @rdroff\n\nrxncor: write unit 21\nclose unit 21\nclose unit 25\nclose unit 26\n\nlabel nomd\n\nopen write unit 3 card name qm.@output.pdb\nwrite coor pdb sele qm end unit 3\nclose unit 3\n\nstream @stream/write.inp\n\nstop\nmakenew_cns.inp\n* constraints\n*\nOPEN UNIT 3 NAME @d/@input.reg READ FORM\nREAD  COOR COMP CARD UNIT 3\nCLOSE UNIT 3\n\n\n! atoms beyond 18A will be held fixed, so only need to add constraints to\n! buffer region atoms within that cutoff\n!set 1 20.0    ! radius for fully mobile region\n!set 2 24.0    ! radius of inner region\n!set 3 22.0    ! radius of buffer region where Langevin dynamics will be used\n\n! Setting various boundary flags\nscalar xcomp store 1    ! initial md region\nscalar ycomp store 2    ! initial buffer region\nscalar zcomp store 3    ! initial Langevin atoms-proteins only\nscalar wcomp store 4    ! reservoir region atoms\n\n! Convert crystallographic thermal factors in wmain to constraint forces\nscalar wmain reci sele recall 3 end               ! get 1/B\nscalar wmain mult 0.001987191 sele recall 3 end   ! k(boltz)/B\nscalar wmain mult @temp sele recall 3 end         ! kT/B\nscalar wmain mult 4.0 sele recall 3 end           ! 4kT/B\nscalar wmain mult 9.87 sele recall 3 end          ! 4(pi**2)kT/B\nscalar wmain set 0.0 sele .not. recall 3 end      ! zero out the rest\nscalar wmain store 5\n\nscalar xcomp set 0.0 sele all end\nscalar ycomp set 0.0 sele all end\nscalar zcomp set 0.0 sele all end\nscalar wcomp set 0.0 sele all end\n\nscalar xcomp recall 3                    ! langevin region constraint flags\nscalar zcomp set 1.0 sele recall 3 .or. (resn TIP3 .and. type OH2) end\nscalar zcomp mult 80.0 sele recall 3 end                     ! protein friction\nscalar zcomp mult 80.0 sele (resn TIP3 .and. type OH2) end   ! TIP3 friction\nscalar ycomp recall 5                    ! unscaled constraint force constants\nscalar wcomp recall 1\n\nopen unit 15 write form name  @d/@output.cnu\nwrite coor comp card unit 15\n* col. 1: langevin region constraint flags\n* col. 2: UNSCALED langevin region harmonic constraint forces\n* col. 3: langevin friction coefficients.\n* col. 4: MD region flags.\n*\n! ****** Scale the constraints based on where the atoms are ******\n! Values of S(r) for scaling the constraint forces\n\nset 4 0.00 !inner langevin region\nset 5 0.08 !next\nset 6 0.20 !next\nset 7 0.32 !next\nset 8 0.44 !next\nset 9 0.50 !next\n\n!calc zones for scaling\ncalc lang = @rsphere - @rdroff\ncalc lang4 = @rdroff \ncalc lang5 = @rdroff + 0.5\ncalc lang6 = @rdroff + 1.0\ncalc lang7 = @rdroff + 1.5\ncalc lang8 = @rdroff + 2.0\n\n!force constant scaling\nscalar xcomp store 1\nscalar ycomp mult @4 sele ( recall 1 .and. point @xcen @ycen @zcen cut @lang4 ) end\nscalar ycomp mult @5 sele ( recall 1 .and. point @xcen @ycen @zcen cut @lang5 -\n                            .and. .not. point @xcen @ycen @zcen cut @lang4 ) end\nscalar ycomp mult @6 sele ( recall 1 .and. point @xcen @ycen @zcen cut @lang6 -\n                            .and. .not. point @xcen @ycen @zcen cut @lang5 ) end\nscalar ycomp mult @7 sele ( recall 1 .and. point @xcen @ycen @zcen cut @lang7 -\n                            .and. .not. point @xcen @ycen @zcen cut @lang6 ) end\nscalar ycomp mult @8 sele ( recall 1 .and. point @xcen @ycen @zcen cut @lang8 -\n                            .and. .not. point @xcen @ycen @zcen cut @lang7 ) end\nscalar ycomp mult @9 sele ( recall 1 .and. .not. point @xcen @ycen @zcen cut @lang8 ) end\n\n!friction scaling\nscalar zcomp mult @4 sele (recall 1 .and. point @xcen @ycen @zcen cut @lang4 -\n       .and. .not. resn TIP3) end\nscalar zcomp mult @5 sele (recall 1 .and. point @xcen @ycen @zcen cut @lang5 -\n       .and. .not. (point @xcen @ycen @zcen cut @lang4 .or. resn TIP3)) end\nscalar zcomp mult @6 sele (recall 1 .and. point @xcen @ycen @zcen cut @lang6 -\n       .and. .not. (point @xcen @ycen @zcen cut @lang5 .or. resn TIP3)) end\nscalar zcomp mult @7 sele (recall 1 .and. point @xcen @ycen @zcen cut @lang7 -\n       .and. .not. (point @xcen @ycen @zcen cut @lang6 .or. resn TIP3)) end\nscalar zcomp mult @8 sele (recall 1 .and. point @xcen @ycen @zcen cut @lang8 -\n       .and. .not. (point @xcen @ycen @zcen cut @lang7 .or. resn TIP3)) end\nscalar zcomp mult @9 sele (recall 1 .and. .not. -\n       (point @xcen @ycen @zcen cut @lang8 .or. resn TIP3)) end\n\nopen unit 14 write form name @d/@output.cns\nwrite coor comp card unit 14\n* col. 1: langevin region constraint flags\n* col. 2: SCALED langevin region harmonic constraint forces\n* col. 3: SCALED langevin friction coefficients.\n* col. 4: MD region flags.\n\nstop\nmakenew_reg.inp\n* center at Cu\n*\n! atoms beyond ? will be held fixed, so only need to add constraints to\n! buffer region atoms within that cutoff\n!set 1 20.0    ! radius for fully mobile region\n!set 2 24.0    ! radius of inner region\n!set 3 22.0    ! radius of buffer region where Langevin dynamics will be used\n!set 1 @rdroff    ! radius for fully mobile region\n!set 2 @rsphere   ! radius of inner region\n!set 3 @rwater    ! radius of buffer region where Langevin dynamics will be used\n\n!all comments were written in a 24/22/20 partition. but the input is general\n\nscalar xcomp set 0.0\nscalar ycomp set 0.0\nscalar zcomp set 0.0\nscalar wcomp set 0.0\n\n! INNER, MOBILE REGION\n! residues with at least one atom within 20-A and\n!   with no main chain atoms outside of 22-A\nscalar xcomp set 1.0 -\n         sele  ( .byres. ( point @xcen @ycen @zcen cut @rdroff ) ) -\n        .and. .not. (( type C  .or. type O  .or. type N .or. -\n                      type CA .or. type HA .or. type HN) -\n        .and. .not. ( point @xcen @ycen @zcen cut @rwater )) end\nscalar xcomp store 1\n\n! INITIAL BUFFER REGION\n! residues with at least one atom within 24-A,  but not already\n!  included in the inner, mobile region\nscalar ycomp set 1.0 sele ( .byres. ( point @xcen @ycen @zcen cut @rsphere ) ) -\n        .and. .not. recall 1 end\nscalar ycomp store 2\n\n! PROTEIN LANGEVIN ATOMS\n! all atoms, except hydrogens and waters in the buffer region\nscalar zcomp set 1.0 sele recall 2 .and. .not. -\n        ( hydrogen .or. lone .or. resname tip3 ) end\nscalar zcomp store 3\n\n! OUTER REGION ATOMS\n! any atom not in the inner or buffer regions\nscalar wcomp set 1.0 sele .not. (recall 1 .or. recall 2 ) end\nscalar wcomp store 4\n!write out the new psf and crd, as well as partition.\n\nopen unit 13 write form name @d/@output.reg\nwrite coor card comp unit 13\n* column 1: reaction region 16 A by residue partioning\n* column 2: Buffer region atoms, any atoms (byres) within @rsphere A but\n*           not in @rdroff A plus all main chain atoms outside @rwater A\n* column 3: Protein Langevin atoms (same as col. 2 but no H or tip3).\n* column 4: Outer region atoms\n*\n\nreturn\nFinalmente, cabe destacar dos cosas:\nSe debe recordar direccionar correctamente los archivos de coordenadas (.crd), de topolog√≠a (.psf), trayectoria (.dcd) y los par√°metros en el archivo conf_template.inp\nPara ejecutar los scripts en bash, primero se les debe dar permiso de ejecuci√≥n, por ejemplo, as√≠: chmod +x 01-create_conf-cfm.sh y luego correrlos de la siguiente manera: ./01-create_conf-cfm.sh\nTodo lo anterior generar√° las carpetas y los archivos necesarios para poder realizar Umbrella Sampling (QM/MM MD) utilizando la interfaz CHARMM-Gaussian.\n\n\n\n",
    "preview": "posts/us_scripts_files/pictures/code.png",
    "last_modified": "2024-11-24T01:33:02-03:00",
    "input_file": {}
  },
  {
    "path": "posts/tutorial_bfee/",
    "title": "Estimador de Energ√≠a Libre de Uni√≥n para sistemas prote√≠na-ligando (BFEE - Plugin de VMD): Tutorial de uso",
    "description": "Aqu√≠ veremos c√≥mo utilizar el Plugin BFEE de VMD de manera sencilla para generar archivos de entrada y as√≠ poder correr los c√°lculos MD del sistema en estudio y as√≠ obtener el &Delta;G¬∫ de uni√≥n por medio del Potencial de Fuerza Medio (PMF).",
    "author": [
      {
        "name": "Camilo Febres-Molina",
        "url": "https://github.com/camilofm"
      }
    ],
    "date": "2022-09-01",
    "categories": [],
    "contents": "\nEste tutorial fue realizado en colaboraci√≥n con Leslie Sanchez.\n\n\n\n\nEl plugin BFEE permite la generaci√≥n de archivos de entrada para realizar el c√°lculo de ŒîG absoluto de uni√≥n en NAMD usando variables colectivas (Fu et al. 2018). Los archivos de entrada se generan en el software VMD, con lo cual se generar√°n los archivos necesarios para realizar los c√°lculos de 8 carpetas. Posteriormente, el plugin permite el procesamiento de los datos.\nEl plugin se debe descargar desde la SI del art√≠culo colocado en la secci√≥n final de Referencias, y que titula: ‚ÄúBFEE: A User-Friendly Graphical Interface Facilitating Absolute Binding Free-Energy Calculations‚Äù.\nEn la SI tambi√©n se encuentran las instrucciones de instalaci√≥n tanto para Windows como para Linux y OSX. (En nuestra experiencia este Plugin responde mejor en Ubuntu que en Windows.)\nGeneraci√≥n de inputs:\nUna vez instalado el plugin en VMD aparecer√° en ‚Äúextensions ‚Üí my plugins ‚Üí BFEE‚Äù. Para su uso es necesario tener archivos del sistema a trabajar equilibrado, ya que para generar los inputs se requieren los siguientes archivos del sistema ‚Üí *.psf, *.coor, *.vel, *.xsc y los archivos de par√°metros necesarios para el sistema en cuesti√≥n.\nEl plugin es bastante user-friendly, por lo que, al abrirlo se entiende d√≥nde hay que poner los archivos requeridos, luego hay que pinchar la opci√≥n ‚Äúgenerar inputs‚Äù, a partir de lo cual se generar√°n 8 carpetas, las cuales se deben transferir al cluster donde est√© instalado NAMD.\nCorrer los archivos en NAMD:\nEn cada carpeta habr√° un archivo de configuraci√≥n ‚Äúabf.conf‚Äù que es el que contiene la informaci√≥n para correr el c√°lculo, del cual no es necesario modificar nada.\nAdem√°s, en cada carpeta existe el archivo colvar.in, que tiene la informaci√≥n de las variables colectivas. Luego de algunos ensayos se observ√≥ que es necesario agregar los keywords ‚ÄúlowerWall‚Äù y ‚ÄúupperWall‚Äù luego de la informaci√≥n de lower y upperboundary, (los valores de los keywords mencionados deben ser iguales, como se muestra a continuaci√≥n en un ejemplo:\n\n\n\nCon esto listo se deben correr las carpetas desde la 001 a la 008 de forma sucesiva.\nNota: Considerar lo siguiente, la carpeta 007 consiste de una solvataci√≥n extra del sistema, por lo cual el plugin construye un nuevo psf y pdb donde la caja de agua es m√°s extensa en tama√±o, con lo cual crece el n√∫mero de √°tomos (en algunos casos al triple). De esto se ha observado que en prote√≠nas donde el n√∫mero de √°tomos supere los ~150 - 200 mil √°tomos, el c√°lculo no se llevar√° a cabo, dado que se generan errores (al menos en la versi√≥n de NAMD que se tiene actualmente instalada en el cluster UDEC) por lo cual ser√° necesario hacer modificaciones en el archivo de la carpeta 007 en caso de que se genere una prote√≠na con un n√∫mero de √°tomos muy grande.\nSe ha seguido la siguiente metodolog√≠a en carpeta 007 para llevar a cabo el c√°lculo:\nTomando como base el archivo bound.psf, bound.coor.pdb (carpeta 007_r), los archivos solvated.psf y solvated.pdb, ligand.pdb y protein.pdb fueron editados para reducir la cantidad de √°tomos (remover las mol√©culas de agua adicionales). Por lo que se realiz√≥ lo siguiente:\nLos archivos bound.psf, bound.coor.pdb, se copiaron a solvated.psf y solvated.pdb. En el archivo solvated.pdb se agreg√≥ 1.00 en la columna A.\nSe tom√≥ ligand.pdb de la carpeta 006 y se copi√≥ por ligand.pdb en la carpeta 007_r. Se agreg√≥ 1.00 en la columna A.\nSe tom√≥ protein.pdb de la carpeta 006 y se copi√≥ por protein.pdb en carpeta 007_r. Se agreg√≥ 1.00 en la columna A.\nDebido a que el archivo solvated.pdb ahora es un sistema m√°s peque√±o se deben cambiar los valores de tama√±o de celda en el archivo abf.conf, para lo cual se utiliza VMD para calcular los valores de celda y centro del sistema (tkconsole, comandos measure minmax y measure center).\nProcesamiento de datos:\nUna vez finalizado el c√°lculo en las 8 carpetas se observar√° que cada carpeta contiene una carpeta ‚Äúoutput‚Äù donde se fueron escribiendo diferentes archivos de salida, entre ellos una trayectoria *.dcd y el archivo que permitir√° obtener el valor de energ√≠a libre, *.czar.pmf, los cuales se deben cargar en la ventana del plugin ‚Äúanalyze‚Äù y luego pinchar ‚Äúcompute binding free energy‚Äù con lo cual se obtendr√° el valor final de energ√≠a libre absoluta (a continuaci√≥n se incluye una imagen de la ventana del plugin donde se deben cargar los respectivos outputs).\n\n\n\n\n\n\nFu, Haohao, James C Gumbart, Haochuan Chen, Xueguang Shao, Wensheng Cai, and Christophe Chipot. 2018. ‚ÄúBFEE: A User-Friendly Graphical Interface Facilitating Absolute Binding Free-Energy Calculations.‚Äù Journal of Chemical Information and Modeling 58 (3): 556‚Äì60.\n\n\n\n\n",
    "preview": "posts/tutorial_bfee/pictures/bfee.png",
    "last_modified": "2024-11-23T23:30:16-03:00",
    "input_file": {}
  },
  {
    "path": "posts/tutorial_gromacs/",
    "title": "An√°lisis post producci√≥n de la din√°mica molecular con Gromacs - Tutorial",
    "description": "Aqu√≠ veremos paso a paso c√≥mo es que podemos utilizar la suite Gromacs para el an√°lisis post producci√≥n de una din√°mica molecular realizada con los programas Gromacs, CHARMM o NAMD.",
    "author": [
      {
        "name": "Dr. Camilo Febres-Molina",
        "url": "https://github.com/camilofm"
      }
    ],
    "date": "2022-08-25",
    "categories": [],
    "contents": "\n\n\n\nExisten muchas metodolog√≠as, softwares y servidores en l√≠nea dise√±ados para analizar la trayectoria obtenida luego de la producci√≥n de una din√°mica molecular (MD) para, as√≠, obtener informaci√≥n que d√© cuenta de la estabilidad de dicha corrida en un per√≠odo espec√≠fico, las fluctuaciones de ciertos residuos, entre otros.\nSin embargo, el paquete de software Gromacs nos permite, en un solo lugar, realizar todos estos an√°lisis y muchos otros de forma relativamente simple y utilizando la l√≠nea de comandos (Abraham et al. 2015; P√°ll et al. 2020).\nEl presente tutorial abarcar√° los siguientes an√°lisis post producci√≥n de la MD:\nRMSD\nRMSF, factor-B y estructura promedio\nRadio de giro\nSASA y energ√≠a libre de solvataci√≥n estimada\nMediciones: distancias, √°ngulos y diedros\nEstructura secundaria\nDensidad\nEnlaces de hidr√≥geno\n\nIndicaciones y recomendaciones iniciales\n\nAntes de iniciar con los diferentes an√°lisis se debe tener en cuenta que la trayectoria a utilizar sea la √≥ptima, por ejemplo, que no contenga ‚Äúsaltos‚Äù o algunas mol√©culas que parecieran estar ‚Äúrotas‚Äù debido a la periodicidad de contorno (PBC) durante la MD.\nPor lo que es una buena pr√°ctica realizar la revisi√≥n de dicha trayectoria (en alg√∫n visualizador, como VMD) o, en su defecto, utilizar el programa trjconv para restaurar dichos ‚Äúsaltos‚Äù o ‚Äúrupturas‚Äù como veremos en el punto 2.\nA lo largo de este tutorial, y a modo de ejemplo, se utilizar√°n los siguientes archivos de entrada iniciales: coor.pdb, traj.dcd y topol.psf (suponiendo que son estos archivos con sus extensiones los que se obtuvieron al realizar la MD luego de correrlos en NAMD o AMBER, por ejemplo).\nLo primero que se debe hacer es convertir la trayectoria traj.dcd a un formato que gromacs utilice y pueda manejar, como traj.trr o traj.xtc, por lo que a trav√©s del programa VMD, y luego de cargar toda la trayectoria (topol.psf + traj.dcd), se guardar√° dicha trayectoria (en ‚ÄúFile‚Äù -> ‚ÄúSave coordinates‚Äù -> ‚ÄúFile type‚Äù) con la extensi√≥n ‚Äútrr‚Äù.\nEl √∫nico inconveniente al convertir la trayectoria a este formato, y no obtenerlo de forma nativa (habiendo corrido la MD con Gromacs), es que las etiquetas de tiempo deber√°n corregirse luego con el graficador que utilicemos (por ejemplo, con Grace).\nTratamiento adecuado de la trayectoria\nEl programa trjconv se utiliza b√°sicamente para convertir la trayectoria trr (generalmente pesada) en otra comprimida y m√°s manejable xtc. Adem√°s tambi√©n se utilizar√° a continuaci√≥n para reparar alg√∫n problema de PBC en la trayectoria inicial.\nEn la misma carpeta en la que est√©n los archivos de entrada que se tienen hasta ahora (y donde debe estar tambi√©n traj.trr) se generar√° un archivo pdb con las coordinadas del frame inicial de la trayectoria (tambi√©n se puede utilizar VMD para esto) y se llamar√° coor-tpr.pdb, esto con la intenci√≥n de utilizarlo en vez del archivo tpr que requieren todos los programas de Gromacs y que sirve de coordenadas de referencia.\nUna vez hecho esto, y en la mencionada carpeta, se correr√° la siguiente l√≠nea de comando en la terminal:\ngmx trjconv -f traj.trr -s coor-tpr.pdb -o traj.xtc -pbc mol -ur compact -center\n-> Para centrar, escoger la opci√≥n ‚Äúprote√≠na‚Äù y como salida la opci√≥n ‚Äúsistema‚Äù.\nCon lo que el archivo de salida aqu√≠ ser√° traj.xtc y es el que se utilizar√° de ahora en adelante para los siguientes an√°lisis.\nCabe mencionar aqu√≠ que as√≠ no existan problemas de ‚Äúsaltos‚Äù o ‚Äúrupturas‚Äù en nuestra trayectoria original (traj.dcd) es una buena pr√°ctica utilizar las opciones -pbc mol, -ur compact y -center, ya que no afectar√°n en nada en el caso de que no se necesiten.\nRMSD\nSe correr√° la siguiente l√≠nea de comando para generar un archivo para ser posteriormente graficado:\ngmx rms -f traj.xtc -s coor-tpr.pdb -o rmsd.xvg\n-> Aqu√≠ se escoger√° a la ‚Äúprote√≠na‚Äù en ambas opciones para que el c√°lculo de la desviaci√≥n media cuadr√°tica sea para esa estructura √∫nicamente y no para todo el sistema.\nUna vez generado el archivo de salida rmsd.xvg se podr√° utilizar un programa (por defecto el formato de dicho archivo es para el programa Grace) para obtener la gr√°fica RMSD de la prote√≠na a lo largo de la MD. Como se mencion√≥ en el punto 1, se debe corregir la etiqueta del tiempo en dicho graficador (que por defecto est√° en ps).\nNota: En el caso de que, a√∫n habiendo realizado el comando del punto 2, se visualice un salto abrupto (anormal) en la gr√°fica del RMSD, se puede correr las siguientes l√≠neas de comando para intentar arreglar el problema:\ngmx trjconv -f traj.xtc -s coor-tpr.pdb -o traj_no-jump.xtc -pbc nojump\ngmx trjconv -f traj_no-jump.xtc -s coor-tpr.pdb -o traj_fit.xtc -fit rot+trans\nHaciendo esto y luego recalculando el RMSD con:\ngmx rms -f traj_fit.xtc -s coor-tpr.pdb -o rmsd_fit.xvg\nSe obtendr√° el nuevo archivo de salida rmsd_fit.xvg con el cual muy probablemente ya se pueda generar una gr√°fica RMSD corregida y sin saltos anormales. S√≥lo si √©ste es el caso, entonces para lo que resta del tutorial se deber√° utilizar el archivo traj_fit.xtc cada que se vea traj.xtc ya que es el corregido.\nEn el caso de que la primera gr√°fica (aquella generada con rmsd.xvg) est√© sin anormalidades se utilizar√° el archivo traj.xtc para lo que resta de los an√°lisis.\nRMSF, factor-B y estructura promedio\nA continuaci√≥n se generar√°n archivos para poder graficar las fluctuaciones por residuo, un pdb que contiene en la columna beta la informaci√≥n sobre dichas fluctuaciones para luego poder representarlo en colores (en VMD, por ejemplo) y otro pdb que contendr√° las coordenadas de la estructura promedio de la trayectoria (o segmento que se escoja de ella).\nPrimero, a trav√©s de la gr√°fica del RMSD anterior, se seleccionar√° la parte de la trayectoria que sea estable para utilizarla. Recordar que por defecto Gromacs utiliza los ps como unidad de tiempo, por lo que se debe conocer el intervalo estable de la mencionada trayectoria en ps (se puede lograr esto viendo el eje x en el gr√°fico RMSD antes de haber corregido los tiempos a ns, como se mencion√≥ en los puntos 1 y 3).\nPara esto, se correr√° la siguiente l√≠nea de comando:\ngmx rmsf -f traj.xtc -s coor-tpr.pdb -oq coor_bfac.pdb -ox coor_avrg.pdb -o rmsf.xvg -res -b A -e B\n-> Se deber√° escoger s√≥lo la prote√≠na para realizar el c√°lculo.\n-> A y B son los tiempos (en ps) del primer y √∫ltimo frame, respectivamente, para ser le√≠dos de la trayectoria completa. Por ejemplo, en el caso que se tenga una trayectoria total de 10 ps (probablemente de 100 ns - recordar que as√≠ lee Gromacs las trayectorias que originalmente son dcd y se convirtieron a trr en VMD) y se sepa que la parte estable es a partir del ps 4.5 (ns 45) hasta el final, entonces, los valores de A y B para la anterior l√≠nea de comando ser√≠an 4.5 y 10, respectivamente.\nDe esta manera se podr√° graficar el archivo de salida rmsf.xvg para obtener el RMSF (por residuo). As√≠ como tambi√©n se habr√°n generado los archivos coor_bfac.pdb y coor_avrg.pdb los que dan cuenta de las coordenadas de la prote√≠na (de referencia - frame inicial) con el factor-B y coordenadas de la estructura promedio, respectivamente, √∫nicamente del intervalo de la trayectoria antes escogido.\nRadio de giro\nCalcular el radio de giro de una prote√≠na sobre los ejes x, y, z como funci√≥n del tiempo es √∫til para conocer el grado de compactaci√≥n que pudo haber sufrido esta estructura a lo largo de la trayectoria.\nSe correr√° la siguiente l√≠nea de comando:\ngmx gyrate -f traj.xtc -s coor-tpr.pdb -o rg.xvg -b A -e B\n-> Se deber√° escoger s√≥lo la prote√≠na.\n-> Siendo A y B los mismos tiempos (en ps) utilizados en el punto 4.\nAs√≠, esto nos arrojar√° un archivo de salida rg.xvg el que se podr√° graficar.\nCabe mencionar que se le llama ‚Äúradio de giro‚Äù pues luego de calcular la ponderaci√≥n por masa de cada √°tomo en el espacio, dichos puntos se comparan frame a frame con el centro de masa de toda la prote√≠na (a modo de colocar esta prote√≠na dentro de una esfera) y el ‚Äúradio‚Äù resultante m√°s alejado del centro es aquel que se asigna en cada frame; finalmente, y a groso modo, se obtienen as√≠ las dos columnas del archivo rg.xvg.\nSASA y energ√≠a libre de solvataci√≥n estimada\nCon la siguiente l√≠nea de comando se calcular√° tanto el √°rea superficial accesible al solvente (tambi√©n conocida como superficie molecular de Lee-Richards) de toda la prote√≠na, como tambi√©n la energ√≠a libre de solvataci√≥n estimada como funci√≥n del tiempo:\ngmx sasa -f traj.xtc -s coor-tpr.pdb -o sasa.xvg -odg delta-g_solv.xvg -b A -e B\n-> Se deber√° escoger s√≥lo la prote√≠na.\n-> Siendo A y B los mismos tiempos (en ps) utilizados en el punto 4.\nCon los archivos de salida generados, sasa.xvg y delta-g_solv.xvg, se podr√° graficar la superficie de Lee-Richards y la energ√≠a libre de solvataci√≥n estimada (con unidades de kJ¬∑mol-1¬∑nm-2), respectivamente, dentro del intervalo de la trayectoria escogido.\nMediciones a lo largo de la trayectoria\nExisten diversas formas de realizar mediciones entre √°tomos, ya sean distancias lineales entre ellos, √°ngulos o diedros.\nPara realizar estas mediciones es necesario generar un archivo index.ndx con el programa make_ndx, as√≠:\ngmx make_ndx -f coor-tpr.pdb -o index.ndx\n-> En el que se escoger√°n √°tomos o residuos que se desee medir creando as√≠ un ‚Äúgrupo nuevo‚Äù con la selecci√≥n de dicho elemento. Cabe recordar que ser√°n dos grupos para la medici√≥n de distancias, tres grupos para medir √°ngulos y cuatro grupos para la medici√≥n de √°ngulos diedros.\nDistancias\nSi se desea medir la distancia entre dos √°tomos o dos residuos, estos √∫ltimos por medio de su centro de masa (com), la l√≠nea de comando deber√° ser algo as√≠:\ngmx distance -f traj.xtc -s coor-tpr.pdb -n index.ndx -oav distance.xvg -select ‚Äúcom of group X plus com of group Y‚Äù -b A -e B\n-> Donde X y Y son los grupos (que poseen un elemento cada uno) que se desea medir, sean √©stos un par de √°tomos (no habr√° problema con que se calcule el centro de masa de un √°tomo, pues ser√°n las mismas coordenadas) o un par de residuos.\n-> Siendo A y B los mismos tiempos (en ps) utilizados en el punto 4.\nDe esta manera se podr√° graficar el archivo de salida distance.xvg y as√≠ conocer la distancia entre √©stos elementos a lo largo de la trayectoria escogida.\n√Ångulos\nPara este caso, la l√≠nea de comando ser√≠a as√≠:\ngmx gangle -f traj.xtc -n index -g1 angle -oav angles.xvg -group1 ‚Äúcom of group X plus com of group Y plus com of group Z‚Äù -b A -e B\n-> Donde X, Y y Z son los grupos con los elementos que se desee medir.\n-> Siendo A y B los mismos tiempos (en ps) utilizados en el punto 4.\nAs√≠, se podr√° graficar el archivo de salida angles.xvg.\nDiedros\nPara el caso de los diedros la l√≠nea de comandos ser√≠a algo as√≠:\ngmx gangle -f traj.xtc -n index -g1 dihedral -oav dihedrals.xvg -group1 ‚Äúcom of group W plus com of group X plus com of group Y plus com of group Z‚Äù -b A -e B\n-> Donde W, X, Y y Z son los grupos que se desee medir.\n-> Siendo A y B los mismos tiempos (en ps) utilizados en el punto 4.\nAs√≠, se podr√° graficar el archivo de salida dihedrals.xvg.\nEstructura secundaria\nPara el c√°lculo de la estructura secundaria de la prote√≠na en funci√≥n del tiempo se necesitar√° realizar la instalaci√≥n de un peque√±o programa llamado dssp, el cual se puede hacer del siguiente sitio web: https://swift.cmbi.umcn.nl/gv/dssp. Adem√°s, Gromacs requiere que el ejecutable de dicho programa est√© localizado en /usr/local/bin/dssp.\nLa siguiente l√≠nea de comando se utilizar√° para realizar este c√°lculo:\ngmx do_dssp -f traj.xtc -s coor-tpr.pdb -map ss.map -o ss.xpm -b A -e B\n-> Donde el archivo de entrada ss.map es aquel que mapea los datos de una matriz a valores RGB que son utilizados por el programa do_dssp. Este archivo debe contener lo siguiente:\n8\n\nCoil 1.0 1.0 1.0\nE B-Sheet 1.0 0.0 0.0\nB B-Bridge 0.0 0.0 0.0\nS Bend 0.0 0.8 0.8\nT Turn 1.0 1.0 0.0\nH A-Helix 0.0 0.0 1.0\nG 3-Helix 1.0 0.0 1.0\nI 5-Helix 1.0 0.6 0.0\n\nEl archivo de salida ss.xpm generado se podr√° convertir a uno de imagen por el programa xpm2ps as√≠:\ngmx xpm2ps -f ss.xpm -di ps.m2p -o ss.eps\n-> Donde el archivo de entrada ps.m2p es aquel que le da los par√°metros (que se pueden modificar) al programa para generar el archivo de salida ss.eps. El archivo ps.m2p debe contener lo siguiente:\n; Command line options of xpm2ps override the parameters in this file\nblack&white = no ; Obsolete\ntitlefont = Times-Roman ; A PostScript Font\ntitlefontsize = 20 ; Font size (pt)\nlegend = yes ; Show the legend\nlegendfont = Times-Roman ; A PostScript Font\nlegendlabel = ; Used when there is none in the .xpm\nlegend2label = ; Used when merging two xpm‚Äôs\nlegendfontsize = 14 ; Font size (pt)\nxbox = 2.0 ; x-size of a matrix element\nybox = 2.0 ; y-size of a matrix element\nmatrixspacing = 20.0 ; Space between 2 matrices\nxoffset = 0.0 ; Between matrix and bounding box\nyoffset = 0.0 ; Between matrix and bounding box\nx-major = 20 ; Major ticks on x axis every .. frames\nx-minor = 5 ; Id. Minor ticks\nx-firstmajor = 0 ; First frame for major tick\nx-majorat0 = no ; Major tick at first frame\nx-majorticklen = 8.0 ; x-majorticklength\nx-minorticklen = 4.0 ; x-minorticklength\nx-label = ; Used when there is none in the .xpm\nx-fontsize = 16 ; Font size (pt)\nx-font = Times-Roman ; A PostScript Font\nx-tickfontsize = 10 ; Font size (pt)\nx-tickfont = Helvetica ; A PostScript Font\ny-major = 20\ny-minor = 5\ny-firstmajor = 0\ny-majorat0 = no\ny-majorticklen = 8.0\ny-minorticklen = 4.0\ny-label =\ny-fontsize = 16\ny-font = Times-Roman\ny-tickfontsize = 10\ny-tickfont = Helvetica\nDe esta manera, se generar√° el archivo de imagen ss.eps con las estructuras secundarias a color de la prote√≠na a lo largo de la trayectoria (o intervalo escogido con las opciones -b A -e B en la primera l√≠nea de comandos).\nPara el caso del c√°lculo de las siguientes dos propiedades, densidad y enlaces de hidr√≥geno, se requerir√° antes generar el archivo de entrada topol.tpr de la siguiente manera:\ngmx grompp -f grompp.mdp -s coor-tpr.pdb -p topol.top -o topol.tpr\n-> El archivo de entrada grompp.mdp, para este caso en particular, no requiere de datos espec√≠ficos, por lo que bastar√° con que contenga las siguientes l√≠neas:\n; grompp.mdp - used as input into grompp to generate topol.tpr\n; Parameters describing what to do, when to stop and what to save\nintegrator = steep ; Algorithm (steep = steepest descent minimization)\nemtol = 1000.0 ; Stop minimization when the maximum force < 1000.0 kJ/mol/nm\nemstep = 0.01 ; Minimization step size\nnsteps = 50000 ; Maximum number of (minimization) steps to perform\n; Parameters describing how to find the neighbors of each atom and how to calculate the interactions\nnstlist = 1 ; Frequency to update the neighbor list and long range forces\ncutoff-scheme = Verlet ; Buffered neighbor searching\nns_type = grid ; Method to determine neighbor list (simple, grid)\ncoulombtype = PME ; Treatment of long range electrostatic interactions\nrcoulomb = 1.0 ; Short-range electrostatic cut-off\nrvdw = 1.0 ; Short-range Van der Waals cut-off\npbc = xyz ; Periodic Boundary Conditions in all 3 dimensions\n-> Por otro lado, el archivo de entrada topol.top es indispensable y se podr√° obtener por medio del servidor https://www.charmm-gui.org/ ‚Üí ‚ÄúInput generator‚Äù ‚Üí ‚ÄúForce Field Converter‚Äù utilizando los archivos de entrada *psf y *crd extra√≠dos de la MD. Luego, se deber√° marcar la opci√≥n ‚ÄúGromacs‚Äù (al llegar al apartado ‚ÄúInput Generation Options‚Äù). Finalmente, luego de descargar los archivos generados comprimidos (*.tgz) y dentro de la carpeta ‚ÄúGromacs‚Äù se encontrar√° el archivo de topolog√≠a que requerimos.\nDe esta manera obtendremos el archivo topol.top necesario para los siguientes c√°lculos. Cabe mencionar que este archivo requiere tambi√©n de los archivos generados de extensi√≥n itp que se encuentran dentro de la carpeta toppar.\nDensidad\nRespecto a este par√°metro, a veces se requiere conocer la densidad de todo el sistema o de alguna de las partes del mismo (sobre todo en el caso de simulaci√≥n de prote√≠nas con membranas lip√≠dicas), por lo que para tal motivo se utilizar√° la siguiente l√≠nea de comando:\ngmx density -f traj.xtc -s topol.tpr -o density.xvg -b A -e B\n-> Aqu√≠ utilizaremos el archivo de entrada recientemente generado topol.tpr\nEl resultado ser√° el archivo de salida density.xvg el que contiene la informaci√≥n de la densidad a lo largo de la trayectoria escogida.\nEnlaces de hidr√≥geno\nSe podr√° calcular la cantidad de enlaces como funci√≥n del tiempo utilizando la siguiente l√≠nea de comando:\ngmx hbond -f traj.xtc -s topol.tpr -num hbnum.xvg -dist hbdist.xvg -ang hbang.xvg -dan danum.xvg -b A -e B\n-> Aqu√≠ utilizaremos el archivo de entrada recientemente generado topol.tpr\n-> El archivo de salida hbnum.xvg contendr√° el n√∫mero total de enlaces de hidr√≥geno por frame a lo largo de la trayectoria escogida.\n-> Los archivos de salida hbdist.xvg y hbang.xvg contendr√°n la distribuci√≥n de la distancia y de los √°ngulos, respectivamente, para todos los enlaces de hidr√≥geno.\n-> El archivo de salida danum.xvg contendr√° el n√∫mero de dadores y aceptores analizados en cada frame de la trayectoria escogida.\nDe esta manera se podr√°n graficar los archivos xvg relacionados con el c√°lculo de los enlaces de hidr√≥geno.\nFinalmente, cabe mencionar que se puede utilizar el programa make_ndx para seleccionar diversos √°tomos, residuos o incluso una mezcla entre √©stos y generar grupos que se guardar√°n en el archivo de salida index.ndx, el que se podr√° utilizar en todos los an√°lisis vistos en el presente tutorial, en el caso que as√≠ lo requiramos, adicionando a la l√≠nea de comandos lo siguiente: -n index.ndx.\n\n\n\nAbraham, Mark James, Teemu Murtola, Roland Schulz, Szil√°rd P√°ll, Jeremy C Smith, Berk Hess, and Erik Lindahl. 2015. ‚ÄúGROMACS: High Performance Molecular Simulations Through Multi-Level Parallelism from Laptops to Supercomputers.‚Äù SoftwareX 1: 19‚Äì25.\n\n\nP√°ll, Szil√°rd, Artem Zhmurov, Paul Bauer, Mark Abraham, Magnus Lundborg, Alan Gray, Berk Hess, and Erik Lindahl. 2020. ‚ÄúHeterogeneous Parallelization and Acceleration of Molecular Dynamics Simulations in GROMACS.‚Äù The Journal of Chemical Physics 153 (13): 134110.\n\n\n\n\n",
    "preview": "posts/tutorial_gromacs/pictures/gromacs.png",
    "last_modified": "2024-11-24T02:00:40-03:00",
    "input_file": {}
  }
]
